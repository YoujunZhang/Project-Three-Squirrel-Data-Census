<!DOCTYPE html>
<html>

<head>
    <title>Interactive Map of Data Points</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@simondmc/popup-js@1.4.2/popup.min.js"></script>
</head>

<body>
    <div class="container">
        <div class="grid-container">
            <div class="character-circle"></div>
            <!-- Grid items will be generated by JavaScript -->
        </div>
        <div id="map"></div>

        <div class="info-container">
            

            <div class="energybar">๐ฐEnergy </div>
            <button id="energy"></button>
    
            <div class="footprintbar">๐ฃFootprint</div>
            <button id="footprint"></button>

        
            <div id="primarycolor">
                Primary Fur Color: 
            </div>
            <div class="filter-options">
                <button class="buttonall" onclick="filterMarkers('all')"></button>
                <button class="buttonorange" onclick="filterMarkers('Cinnamon')"></button>
                <button class="buttongrey" onclick="filterMarkers('Gray')"></button>
                <button class="buttonblack" onclick="filterMarkers('Black')"></button>
            </div>


            <div class="filtercircle"></div>
            <div class="right1" >
                <img src="IMG_2335.PNG" height="325px", width="325px">
                
            </div>
          

            <div class="righttext">
            <a href="https://www.thesquirrelcensus.com/" id="title">๐ฟ๏ธ ๐ ๐</a>
            <div id="subtitle">New York City 2018 Squirrel Census</div>
            <div>Fur Color Map:</div>
            <div>A multimedia science, design, and storytelling project focusing on the Eastern gray (Sciurus
                carolinensis). They count squirrels and present their findings to the public. This table contains
                squirrel data for each of the 3,023 sightings, including location coordinates, age, primary and
                secondary fur color, elevation, activities, communications, and interactions between squirrels and with
                humans.</div>
              
                <div>
                    ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
                </div>
                <div>
                    ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
                    ยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยทยท
                </div>
            
              

            </div>
            <div id="credit">
                Website Designed by Youjun Zhang
            </div>
            <div id="bottom">
                ยฉYoujun Zhang 2024
            </div>
        </div>
    </div>

    <script>
   
        document.addEventListener('DOMContentLoaded', function () {
            const gridContainer = document.querySelector('.grid-container');
            for (let i = 0; i <= 34; i++) {
                let div = document.createElement('div');
                div.className = 'grid-item';
                gridContainer.appendChild(div);
            }

            let map = L.map('map').setView([40.7826, -73.968285], 15);
            let markers = [];
            let stampIndex = 0;

            L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/light_nolabels/{z}/{x}/{y}.png', {
                maxZoom: 19
            }).addTo(map);

            fetchMarkers();

            function fetchMarkers() {
                fetch('https://data.cityofnewyork.us/resource/vfnx-vebw.json')
                    .then(response => response.json())
                    .then(data => {
                        data.forEach(item => {
                            addMarker(item.y, item.x, item.primary_fur_color, item.date || 'Gray', item.primary_fur_color);
                        });
                    })
                    .catch(error => console.error('Error loading data: ' + error));
            }

            function addMarker(lat, lon, color, popupInfo) {
                let iconUrl = {
                    'Gray': 'IMG_2348.PNG',
                    'Cinnamon': 'IMG_2333.PNG',
                    'Black': 'IMG_2349.PNG',
                }[color] || 'marker_grey.png';

                let icon = new L.Icon({
                    iconUrl: iconUrl,
                    iconSize: [45, 55],
                    iconAnchor: [12, 41]
                });

                let marker = L.marker([lat, lon], { icon: icon, color: color }).addTo(map);

                marker.bindPopup("<b class='popupinfo'>" + popupInfo + "</b><br>๐ฐ Location:    (73, 40) | Tail Flags:    False | Tail Twitches:    False | Approaches:    False | Chasing:    True | Foraging:    True | Eating:    False");

                marker.on('click', () => {
                    if (stampIndex < 36) {
                        document.querySelectorAll('.grid-item')[stampIndex].style.backgroundImage = 'url("stamp.png")';
                        console.log(stampIndex);
                        var energyButton = document.getElementById('energy');
                        energyButton.style.width = (parseInt(energyButton.offsetWidth) + 5)+"px";

                        var footprintButton = document.getElementById('footprint');
                        footprintButton.style.width = (parseInt(energyButton.offsetWidth) + 5)+"px";


                        // const computedStyle = window.getComputedStyle(energyButton);
                        // const width = computedStyle.getPropertyValue("width");
                        // console.log(width);
                        // energyButton.setAttribute("style","width:500px");

                        if (stampIndex %5 === 4) {
                            const myPopup = new Popup({
                                id: "my-popup",
                                title: "๐ฐโจHabitatโจ๐ฐ",
                                content: `

Squirrels live in almost every habitat, fromยtropical rainforest to semiarid desert, avoiding only the high polar regions and the driest of deserts.
Squirrels prefer habitats with a moderate to dense understory of vines and shrubs that provide cover and concealment.ยThey also thrive in forests with at least 50 to 75 nut and shelter trees, such as hickory, oak, walnut, pecan, elm, maple, and mulberry trees.`,
    titleColor: "white",
    titleMargin: "0",
    backgroundColor: "rgb(202, 131, 0)",
    fontFamily: "Monospace",
    fontSizeMultiplier: 0.45,
    textColor: "white",
    titleMargin: "2em",


    

                            });
                            myPopup.show();
                        }
                        stampIndex++;
                    }
                });
                markers.push(marker);
            }



//             const element = document.getElementById('my-popup')
// element.style.fontFamily = 'cursive'


            

            window.filterMarkers = function (color) {
                markers.forEach(marker => {
                    if (color === 'all' || marker.options.color === color) {
                        map.addLayer(marker);
                    } else {
                        map.removeLayer(marker);
                    }
                });
            };
        });
    </script>
</body>

</html>